# ==============================================================================
# Image Classification Configuration
# ==============================================================================
# Configuration file for initializing an annotation session for image
# classification tasks.
#
# This configuration sets up the data paths, feature extraction parameters,
# ML training parameters, and class definitions for the active annotation
# workflow.
# ==============================================================================

# ==============================================================================
# TASK TYPE
# ==============================================================================

# Task type for this session - determines the annotation workflow and model architecture
# Valid values: "segmentation" or "classification"
task: "classification"

# ==============================================================================
# DATA PATHS
# ==============================================================================

# Path to directory containing input images
# The script will recursively search this directory for images matching the
# specified formats below.
image_dir: "/Users/houtj/projects/active_annotation/data/img_samples"

# Comma-separated list of image file formats to process
# Common formats: png, jpg, jpeg, tif, tiff
# The script will search for both lowercase and uppercase extensions
formats: "png,jpg,jpeg"

# Optional: Path to directory containing pre-existing label JSON files
# If provided, the script will attempt to import labels that match image names
# Set to null or empty string if no labels are available
labels_dir: null

# Optional: Maximum number of image files to process
# Useful for testing or working with a subset of data
# Set to null to process all images
max_files: 100


# ==============================================================================
# SESSION AND MODEL PATHS
# ==============================================================================

# These paths are relative to the project root and typically don't need changes
# unless you have a custom directory structure

# Session directory where annotations, features, and checkpoints are stored
# Default: ../session (relative to initialization folder)
session_dir: "../session"

# Path to DINOv3 model repository
# Default: ../models/dinov3 (relative to initialization folder)
dinov3_repo: "../models/dinov3"

# Path to DINOv3 pretrained weights
# Default: ../models/weights/dinov3_vits16_pretrain_lvd1689m-08c60483.pth
weights_path: "../models/weights/dinov3_vits16_pretrain_lvd1689m-08c60483.pth"


# ==============================================================================
# FEATURE EXTRACTION
# ==============================================================================

# Target size for DINOv3 feature extraction (in pixels)
# Images are resized so their largest dimension equals this value, then
# zero-padded to a square. The value must be a multiple of 16 (DINOv3 patch size).
# 
# Guidelines:
#   - Higher values preserve more detail but increase memory and computation
#   - 1536 is recommended for high-resolution images
#   - 1024 works well for medium-resolution images
#   - 512 for lower-resolution or faster processing
resize: 1536


# ==============================================================================
# CLASS DEFINITIONS
# ==============================================================================

# Multi-class classification classes
# Each class has a name and color (hex format) for visualization

classes:
  - name: "animal"
    color: "#FF5733"  # Red-orange
    
  - name: "car"
    color: "#33FF57"  # Green
    
  - name: "human"
    color: "#3357FF"  # Blue
    
  - name: "other"
    color: "#F0F0F0"  # Light gray


# ==============================================================================
# ML TRAINING PARAMETERS
# ==============================================================================

# Number of training epochs between generating predictions on the current file
# During training, the model will generate predictions periodically to provide
# feedback to the user. Lower values = more frequent predictions but slower training.
# Typical range: 10-50
prediction_interval: 20

# Number of epochs to wait for improvement before early stopping
# Training stops if the test loss doesn't improve for this many epochs
# Higher values give more time for convergence but may overtrain
# Typical range: 3-10
early_stop_patience: 5

# Minimum improvement threshold for early stopping
# Only improvements greater than this value count as "real" improvements
# Prevents stopping due to tiny fluctuations in loss
# Typical range: 0.0001 - 0.01
early_stop_threshold: 0.001


# ==============================================================================
# NOTES FOR CLASSIFICATION TASKS
# ==============================================================================
# 
# Image classification involves assigning a single class label to each image.
# Key considerations:
#
# 1. FEATURE EXTRACTION:
#    - Use resize=1536 for high-resolution images
#    - For smaller images or faster processing, consider 1024 or 512
#
# 2. CLASS DEFINITIONS:
#    - Define all possible classes in the classes section above
#    - Use descriptive names and distinct colors for easy visualization
#    - Add more classes as needed for your specific task
#
# 3. TRAINING:
#    - prediction_interval=20 provides good balance between feedback and speed
#    - early_stop_patience=5 prevents overfitting on small annotation sets
#    - Model uses global average pooling over DINOv3 features
#
# 4. DATA ORGANIZATION:
#    - Organize images in a flat directory or by category
#    - Use consistent file naming for easier management
#    - No need for label files initially - annotate through the UI
#
# ==============================================================================
